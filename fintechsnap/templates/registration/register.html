{% extends "base.html" %}
{% load static %}

{% block title %}Register — FinMentor{% endblock %}

{% block content %}

<div class="bg-gray-50 flex items-start justify-center px-6 pt-6 pb-6">
  <div class="max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-12">

    <!-- LEFT SIDE (illustration + text) -->
    <div class="flex flex-col justify-center max-w-lg">
      <p class="mt-4 text-base text-gray-600 leading-relaxed">JOIN THE COMMUNITY</p>

      <h1 class="text-4xl lg:text-5xl font-extrabold text-slate-800 leading-tight">
        Create your <span class="text-indigo-700">FinMentor</span> account
      </h1>

      <p class="mt-6 text-lg text-gray-600 leading-relaxed">
        Start your journey toward better financial habits.  
        Track progress, get insights, and take control — one step at a time.
      </p>

      <!-- using the uploaded image path so you see the same image you shared -->
      <img src="{% static 'images/register2.png' %}"
        class="mt-5 w-33 opacity-90 hidden lg:block rounded-md shadow-sm"
        alt="register illustration">

    </div>

    <!-- RIGHT SIDE (Register Form) -->
    <div class="bg-[#fff3e6] border border-gray-800 rounded-[28px]
            px-8 py-6 shadow-sm max-w-md w-full self-center">

      <h2 class="text-2xl font-bold text-slate-800 mb-6">Create Account</h2>

      <!-- Django form errors -->
      {% if form.non_field_errors %}
        <div class="mb-4 text-red-600 text-sm bg-red-50 border border-red-200 p-3 rounded-lg">
          {{ form.non_field_errors }}
        </div>
      {% endif %}

      <form method="post" novalidate>
        {% csrf_token %}

        <!-- Username (styled explicitly so it looks like the password boxes) -->
        <label for="username" class="block font-medium text-gray-700 mb-1">Username</label>
        <input
          id="username"
          name="username"
          type="text"
          value="{{ form.username.value|default:'' }}"
          class="w-full px-4 py-3 mb-4 rounded-full border border-gray-400 py-2.5 px-4 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none"
          placeholder="e.g. riya123"
          required
        />
        <div class="text-red-600 text-sm mb-3">
          {{ form.username.errors }}
        </div>

        <!-- Password -->
        <label for="password1" class="block font-medium text-gray-700 mb-1">Password</label>
        <div class="relative mb-3">
          <input
            id="password1"
            name="password1"
            type="password"
            class="w-full px-4 py-3 rounded-full border border-gray-400 py-2.5 px-4 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none"
            placeholder="Create a password"
            required
          />
          <button type="button"
                  id="togglePassword1"
                  class="absolute inset-y-0 right-3 flex items-center text-gray-500 hover:text-gray-700">
            <svg id="eyeIcon1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
          </button>
        </div>
        <div class="text-red-600 text-sm mb-3">{{ form.password1.errors }}</div>

        <!-- Confirm Password -->
        <label for="password2" class="block font-medium text-gray-700 mb-1">Confirm Password</label>
        <div class="relative mb-1">
          <input
            id="password2"
            name="password2"
            type="password"
            class="w-full px-4 py-3 rounded-full border border-gray-400 py-2.5 px-4 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none"
            placeholder="Re-enter your password"
            required
          />
          <button type="button"
                  id="togglePassword2"
                  class="absolute inset-y-0 right-3 flex items-center text-gray-500 hover:text-gray-700">
            <svg id="eyeIcon2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
          </button>
        </div>

        <!-- Live-match error (hidden when passwords match) -->
        <div id="pwMismatch" class="text-red-600 text-sm mb-4 hidden">
          Passwords do not match.
        </div>
        <div class="text-red-600 text-sm mb-4">{{ form.password2.errors }}</div>

        <!-- Submit -->
        <button
          id="createBtn"
          type="submit"
          style="background-color:#9370DB"
          class="w-full mt-2 py-3 text-white font-semibold rounded-lg shadow-md hover:opacity-90 transition">
          Create Account
        </button>

      </form>

      <p class="mt-6 text-sm text-gray-600">
        Already have an account?
        <a href="{% url 'login' %}" class="text-indigo-600 font-semibold hover:underline">Log in</a>
      </p>

    </div>

  </div>
</div>

{% endblock %}
{% block scripts %}
<script>
/* Toggle eye icons / show-hide password */
function setupToggle(btnId, fieldId) {
  const btn = document.getElementById(btnId);
  const field = document.getElementById(fieldId);
  if (!btn || !field) return;

  btn.addEventListener("click", () => {
    field.type = field.type === "password" ? "text" : "password";
  });
}

setupToggle("togglePassword1", "password1");
setupToggle("togglePassword2", "password2");

/* Live password match validation */
const pw1 = document.getElementById("password1");
const pw2 = document.getElementById("password2");
const mismatchDiv = document.getElementById("pwMismatch");

function checkMatch() {
  if (!pw1.value || !pw2.value) {
    mismatchDiv.classList.add("hidden");
    return;
  }
  if (pw1.value !== pw2.value) {
    mismatchDiv.classList.remove("hidden");
  } else {
    mismatchDiv.classList.add("hidden");
  }
}

pw1.addEventListener("input", checkMatch);
pw2.addEventListener("input", checkMatch);
</script>
{% endblock %}
